<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShopHub - Cart</title>
    <link rel="stylesheet" href="cart.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    
</head>

<body>
    <!-- NAVBAR -->
    <nav class="shophub-navbar">
        <div class="navbar-container">
            <button class="navbar-toggle" id="navbarToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <a href="index.html" class="navbar-logo">
                üõçÔ∏è <span>ShopHub</span>
            </a>

            <ul class="navbar-links" id="navbarLinks">
                <li><a href="index.html" class="navbar-link">Home</a></li>
                <li><a href="#" class="navbar-link">About</a></li>
                <li><a href="#" class="navbar-link">Products</a></li>
                <li><a href="wishlist.html" class="navbar-link">‚ù§Ô∏è Wishlist</a></li>
                <li><a href="#" class="navbar-link logout">Logout</a></li>
            </ul>

            <a href="cart.html" class="navbar-cart">
                üõí <span class="cart-badge" id="cartBadge">0</span>
            </a>
        </div>
    </nav>

    <!-- CART CONTAINER -->
    <div class="cart-container">
        <div class="cart-header">
            <a href="index.html" class="back-button">‚Üê Continue Shopping</a>
            <h1>üõí My Shopping Cart</h1>
        </div>

        <div class="cart-content" id="cartContent">
            <!-- Cart items will be loaded here -->
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // NAVBAR TOGGLE
        const navbarToggle = document.getElementById('navbarToggle');
        const navbarLinks = document.getElementById('navbarLinks');

        if (navbarToggle && navbarLinks) {
            navbarToggle.addEventListener('click', () => {
                navbarLinks.classList.toggle('active');
                navbarToggle.classList.toggle('active');
            });

            document.querySelectorAll('.navbar-link').forEach(link => {
                link.addEventListener('click', () => {
                    navbarLinks.classList.remove('active');
                    navbarToggle.classList.remove('active');
                });
            });
        }

        // PRODUCT ICONS
        const productIcons = {
            'Watch': '‚åö',
            'Laptop': 'üíª',
            'Smartphone': 'üì±',
            'Headphones': 'üéß',
            'Tablet': 'üì±'
        };

        // GET STOCK CLASS
        function getStockClass(quantity) {
            if (quantity <= 5) return 'stock-low';
            if (quantity <= 10) return 'stock-medium';
            return 'stock-high';
        }

        // LOAD CART ITEMS
        function loadCart() {
            const products = JSON.parse(localStorage.getItem('shophub_products') || '[]');
            const cartProducts = products.filter(p => p.cart === true);

            updateCartBadge(cartProducts.length);

            const cartContent = document.getElementById('cartContent');

            if (cartProducts.length === 0) {
                cartContent.innerHTML = `
                    <div class="cart-items-section">
                        <div class="empty-cart">
                            <div class="empty-cart-icon">üõí</div>
                            <h2>Your cart is empty!</h2>
                            <p>Add some products to get started</p>
                            <a href="index.html" class="back-button">Start Shopping</a>
                        </div>
                    </div>
                `;
                return;
            }

            // Calculate total
            let total = 0;
            cartProducts.forEach(p => {
                total += p.Price;
            });

            // Render cart items
            let cartItemsHTML = '';
            cartProducts.forEach((product, index) => {
                const icon = productIcons[product.Name] || 'üè∑Ô∏è';
                const stockClass = getStockClass(product.Quantity);
                const originalIndex = products.findIndex(p => 
                    p.Name === product.Name && 
                    p.Price === product.Price && 
                    p.image === product.image &&
                    p.cart === true  // Multiple same products ‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡Ææ confusion avoid ‡Æ™‡Æ£‡Øç‡Æ£
                );

                cartItemsHTML += `
                    <div class="cart-item" data-index="${originalIndex}">
                        <img src="${product.image}" alt="${product.Name}" class="cart-item-image">
                        <div class="cart-item-details">
                            <div class="cart-item-name">${icon} ${product.Name}</div>
                            <div class="cart-item-price">‚Çπ${product.Price.toLocaleString()}</div>
                            <div class="cart-item-stock">
                                <span>Stock: </span>
                                <span class="quantity-badge ${stockClass}">${product.Quantity} units</span>
                            </div>
                        </div>
                        <div class="cart-item-actions">
                            <button class="remove-button" onclick="removeFromCart(${originalIndex})">
                                üóëÔ∏è Remove
                            </button>
                        </div>
                    </div>
                `;
            });

            cartContent.innerHTML = `
                <div class="cart-items-section">
                    ${cartItemsHTML}
                </div>
                <div class="cart-summary">
                    <div class="summary-title">Order Summary</div>
                    <div class="summary-row">
                        <span>Items (${cartProducts.length})</span>
                        <span>‚Çπ${total.toLocaleString()}</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping</span>
                        <span style="color: #51cf66;">FREE</span>
                    </div>
                    <div class="summary-total">
                        <span>Total</span>
                        <span>‚Çπ${total.toLocaleString()}</span>
                    </div>
                    <button class="checkout-button" onclick="checkout()">
                        Proceed to Checkout
                    </button>
                    <a href="index.html" class="continue-shopping">
                        Continue Shopping
                    </a>
                </div>
            `;
        }

        // UPDATE CART BADGE
        function updateCartBadge(count) {
            const badge = document.getElementById('cartBadge');
            if (badge) {
                badge.textContent = count;
            }
        }

        // REMOVE FROM CART
        function removeFromCart(index) {
            // Get products from localStorage
            let products = JSON.parse(localStorage.getItem('shophub_products') || '[]');
            
            if (products[index]) {
                // Only set cart to false, don't remove the product
                products[index].cart = false;
                
                // Save back to localStorage
                localStorage.setItem('shophub_products', JSON.stringify(products));
                
                // Reload cart
                loadCart();
            }
        }

        // CHECKOUT
        function checkout() {
            alert('Proceeding to checkout... üéâ');
            // Add your checkout logic here
        }

        // Initialize cart on page load
        window.addEventListener('DOMContentLoaded', loadCart);
    </script>
</body>

</html>